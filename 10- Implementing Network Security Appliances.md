# Implementing Network Security Appliances

# PACKET FILTERING FIREWALLS

- **Access Control List (ACLs)**

-دي عباره عن ليست من القواعد اللي بتكون في الfirewall وفيها انا بقدر احدد مين يخش علي الشبكه ومين لأ وكل واحد مسموحله يعمل ايه

-يعني مثلا انا دلوقتي لو عاوز اروح افتح موقع فيسبوك فا طبعا الطلب بتاعي هيعدي علي ال firewall فا هيقولي استني اما اشوف انت مسموح عندي اصلا تطلع علي الانترنت ولا لأ فا بص فالورقه قال اه انت مسموحلك فا بيسمحلي اني اطلع علي الانترنت وافتح الفيس وكدا هو عملي accept لو منعني يبقي كدا عملي deny

-خليك عارف اني ال firewall لما حاجه بتعدي عليه بيبص علي ال ip بتاع المصدر والوجهه والبروتوكل المستخدم في عملية الاتصال دي والبورت اللي طالع منو الاتصال والبورت اللي رايحله

### تحديد نوع الحركه

1. حركة الدخول (Inbound Traffic)
- ده بيعرف كمان باسم Ingress Traffic , ودا بيمثل الtraffic اللي جاي من برا من الانترنت لجوا الشبكه
1. حركة الخروج (Outbound Traffic)
- ده بيعرف كمان باسم Egress Traffic , ودا بيمثل الtraffic اللي جاي من جوا الشبكه رايح علي الانترنت

---

## Firewalls Types

### 1. Stateless Operation

- دا نوع من انواع ال firewalls مبيخزنش معلومات عن الاتصال بس انا مش فاهم تعال افهمك
- انا دلوقتي لو روحت حبيت اتصفح موقع فيسبوك فا عديت علي ال firewall قالي تمام انت مسموحلك انت تأكسس علي النت فا عداني جه بقي الفيس يرد عليا ويحملي الموقع فا ال firewall قالو استني رايح فين استني اشوف انت مسموحلك تعدي عندي ف ال ACL ولا لأ فا هيقولي دا محمد لسه طالبني من شويه فا يقولو لا والله انا مبخزنش معلومات الاتصال
- النوع ده من ال firewalls بيكون اكتر امان لأنو ف كل request و response بيعمل check ويشوف
- النوع ده بيكون بطئ شويه عشان بيقعد كل شويه يفحص بس امان اكتر

### 2. Stateful Operation

- دا نوع من انواع ال firewalls بيخزن معلومات عن الاتصال
- يعني لو جيت بقي اتصفح الفيسبوك المرادي ال firewall هيعديني وهيسبلي port مفتوح بحيث لما ال facebook يرد يعديه علاطول من غير ما يسأله
- معلومات الاتصال دي بتكون متحزنه ف حاجه اسمها state table وبيكون للاتصال وقت معين ويتمسح من الtable عشان لو فضل موجود دا هيمثل خطر علي الشبكه وممكن حد يهكرها
- النوع دا من ال firewalls بيكون مش امان خالص لأني ممكن حد يستخدم هجمات زي ال spoofing ويخش من ال port المفتوح ده
- وبرضو النوع ده بيكون الاتصال فيه سريع بس مش امان

![image.png](image.png)

## STATEFUL INSPECTION FIREWALLS

### 1. Transport Layer (OSI Layer 4)

- دا نوع من ال firewalls اخره يبص علي ال ip بتاع الراسل والمستقبل والبروتوكل المستخدم والبورت وكل ده
- يعني لو استخدمت برامج معينه مش هيقدر يمنعني من ده

### 2. Application Layer (OSI Layer 7)

- دا بقا نوع firewall بيقدر انو يشوفني وانا بستخدم اي حاجه ف عملية الtaffic ويشوف انا مستخدم بروتوكل ايه وبرنامج ايه وكل ده وممكن يمنعني من استخدام برنامج معين او بروتوكل معين

## Firewall Appliances

### **1. Routed Firewall (Layer 3)**

- **الوصف:**
    - الجدار الناري بيعمل وظيفة التوجيه (Forwarding) بين الشبكات الفرعية (Subnets).
    - كل واجهة (Interface) في الجدار الناري بتتصل بشبكة فرعية مختلفة وبتكون بتمثل منطقة أمان منفصلة (Security Zone).

---

### **2. Bridged Firewall (Layer 2)**

- **الوصف:**
    - الجدار الناري بيحلل الترافيك اللي بيعدي بين **جهازين** (زي راوتر وسويتش).
    - يُطلق عليه كمان **Transparent Mode** لأنه بيشتغل بشفافية بدون ما يكون له عنوان IP (إلا لو للإعدادات فقط).
    - الجدار الناري بيربط واجهات الإيثرنت (Ethernet Interfaces) بين الجهازين.
- **المزايا:**
    - بالرغم إنه بيشتغل على **الطبقة 2**، لكنه قادر يفحص الترافيك ويفلتره بناءً على كل أنواع رؤوس الحزم (Packet Headers).
- **الاستخدام المعتاد:**
    - شائع في الحالات اللي محتاجة **فلترة شفافة** بدون تغيير هيكل الشبكة.

---

### **الفرق الأساسي:**

| **النوع** | **الطبقة** | **الوظيفة** | **الاستخدام** |
| --- | --- | --- | --- |
| **Routed** | Layer 3 | توجيه الترافيك بين الشبكات الفرعية (Subnets). | تقسيم الشبكة إلى مناطق أمان منفصلة. |
| **Bridged** | Layer 2 | تحليل وفلترة الترافيك بين جهازين بدون تغيير هيكل الشبكة. | فلترة شفافة بين جهازين مثل راوتر وسويتش. |

*في بعض الراوترات بيكون فيها بعض مميزات ال firewall ودا لما بيكون ميزانية الشركه قليله فا بيجيبو راوتر وبيكون في بعض مميزات ال firewall ويبقي اتنين في واحد , بس طبعا ده مبيكونش بنفس قوة ال firewall العادي*

---

## Virtual Firewalls

1. **Hypervisor-based**
- دا نوع من ال firewalls بيكون شغال في النظام او السيرفر كنظام وهمي بيشتغل علي ال virtual box او vmware
1. **Virtual Appliance**
- ودا بيكون جهاز ولكن جهاز وهمي
1. **Multiple Context**
- هيشتغل كنظام وهمي فالجهاز بس عادي اقسمه يعني يبقو اتنين firewall

---

## NETWORK-BASED INTRUSION DETECTION SYSTEMS

### intrusion detection system (IDS)

- ودا نظام كشف الدخلاء بحيث لو لقي في traffic مش مظبوط وفي حد بيحاول يأكسس علي الشبكه بيدي alert بس مبيقدرش ياخد action تجاه ال attack لأنو هو من مهامه انو يكتشف بس الحاجه الضاره
- هنهتم ب network ids NDIS
- في برامج كتير تقدر تشتغل as a NDIS زي snort او suricata
- فكرة عمل ال IDS عمتا بيكون عباره عن نوعين تعالي اعرفك عليهم

### 1. Signature-based detection

- ودا طريقة عمله بتكون انه بيخزن ف database خاصه بيه كل الثغرات او الحاجات الضاره بحيث لما يكون في traffic بيعمل عليه check هل انت موجود عندي ف ال signature ولا لأ لو مش موجود هيعديه عادي لو موجود هيبدأ انو يدي alert عشان يعرف ال network admin اني في malicious traffic
- لازم احدث ال IDS ده كل يوم ان لم يكن كذا مره ف اليوم عشان يكون محدث دايما باحدث ال malwares

![image.png](image%201.png)

### 2. Behavioral-based detection

- ودا طريقة عمله مش بتعتمد بقي علي database وكدا لأ
- بتعتمد علي السلوك يعني لو في جهاز بيعمل حاجه مش طبيعيه زي انو بيبعت طلبات ping كتير علي اجهزه كتير او انه بيبعت packets لكل اجهزة الشبكه فا بيدي alert برضو فالحاله دي
- This type of detection was provided by network behavior and anomaly detection (NBAD)
products.
- An NBAD engine uses heuristics to generate a statistical model of what baseline normal
traffic looks like.

### **تعريف NIDS (Network-based Intrusion Detection System):**

- **NIDS** بيتم استخدامه عشان:
    - **تحديد الهوستس والتطبيقات** اللي شغالة على الشبكة.
    - **كشف الهجمات** زي:
        - توقيعات الهجوم (Attack Signatures).
        - محاولات تخمين كلمات السر (Password Guessing).
        - فحص المنافذ (Port Scans).
        - الفيروسات الدودية (Worms).
        - التطبيقات اللي بتعمل Backdoors.
        - الحزم أو الجلسات الغير صحيحة (Malformed Packets/Sessions).
        - انتهاكات السياسات (زي استخدام IP أو منافذ غير مسموح بيها).

---

### **2. استخدامات NIDS:**

- **تحليل السجلات (Logs):**
    - بيتم تحليل السجلات اللي بيوفرها الـ NIDS لتحسين إعدادات الأمان.
- **تعديل قواعد الجدار الناري (Firewall Rules):**
    - بناءً على التحليل، ممكن يتم تعديل قواعد الجدار الناري لحظر نشاطات مشبوهة.
- **حظر الهوستس المشبوهة:**
    - إزالة أو حظر الأجهزة أو العمليات اللي بتشكل تهديد للشبكة.
- **تعزيز الحماية:**
    - إضافة وسائل أمان إضافية بناءً على التهديدات اللي تم اكتشافها.

### **الهدف الأساسي:**

- مراقبة الترافيك على الشبكة وتحليل النشاطات المشبوهة عشان تمنع الهجمات وتحسن إعدادات الأمان.

---

### intrusion prevention system (IPS)

- دا بقي عكس ال IDS لو في محاولة اختراق بيتم كشفها وبيوقفها كمان
- بيعمل في ال inline بيبقي ف خط دخول ال packet للشبكه عشان اول لما ال packet تحاول تخش الشبكه هيفحصها علي طول ويشوف لو هيا عاديه ولا ضاره

---

### Next-Generation Firewall

- ودا انواع firewalls متقدمه شويه يعني ال firewall بيكون فيه IPS جاهز جاي معاه فا بالتالي يقدر ال firewall يفحص ال header بتاع ال packet وال payload بتاعها كمان عشان يعرف اذا كان هيا ضاره ولا لأ
- خلي بالك ال firewall العادي مبيبصش علي ال payload بتاع اي باكيت بيبص علي ال header عشان هو مهتمه انو يسمح لحد او ميسمحش لحد فا مش هيبص علي المحتوي هو هدفه انو يعرف دا مين وهل مسموحله يعدي او لأ بس انما ال IPS وال IDS بيبصو علي المحتوي عشان دا اللي من خلاله بيقدرو يعرفو اذا كان دا باكيت ضار ولا لأ

### Unified Threat Management (UTM)

- وده بقي الجهاز الاكثر شمولا , حرفيا بيعمل كل حاجه
- بيقدر يشتغل كا firewall, anti-malware, network intrusion
prevention, spam filtering, content filtering, data loss prevention, VPN, cloud
access gateway
- خلي بالك ممكن يهنج معاك لو ال traffic اللي داخل او خارج كتير عشان طبعا بيفحص حاجات كتير جدا زي مانت شايف فا ده مبينصحش بيه ف الشركات الكبيره افضل اختيار بيكون ال next-generation firewall انما لو شركه صغيره هيشتغل تمام

### WEB APPLICATION FIREWALLS (WAF)

- دا firewall بيكون مخصص بس لحماية السيرفرات وبيحميها من هجمات زي DOS او DDOS
- اشهر ال WAFs زي Modsecuirty , Naxsi , Imperva

---

## Security Information & Event Management (SIEM)

- ال SIEM Solution عباره عن نقطة مركزيه بيتجمع فيها كل ال logs وال Events بتاعت كل الاجهزه اللي عالشبكه كل جهاز حرفيا
- تخيل معايا لو انت SOC Analyst فا اكيد انت دلوقتي عاوز تعرف ال Log بتاع علي هتروح علي جهاز علي وتشوف مثلا عاوز تشوف Log ياسر فا هتروح تشوف من الجهاز بتاعه فا طبعا دي مش طريقه احترافيه فا الاجهزه بتاعت الشبكه كلها من بي سي او لابات او موبايلات او سويتشات او راوترات او IPS وما الي ذلك كل ال Logs بتاعهم بيتجمعو ف نقطة مركزيه اسمها SIEM ويقدر ال SOC Analyst يشوف ال Logs بتاع كل الاجهزه متجمعين ف حته واحده
- بيتعمد السيم سوليوشن علي بروتوكول ال SNMP عشان يقدر يعرف استهلاك ال CPU وال Memory بتاع كل الاجهزه اللي عالشبكه
- هناك انواع لل SIEM زي :
- Splunk االشهر
- logRHythm االشهر
- QRadar االشهر
- Mcafee
- Trustware

### Security Orchestration, Automation, and Response (SOAR)

- وده بقي اللي بياخد action لما ال SIEM بيكتشف حاجه ضاره يعني مثلا لو في ip معين بيعمل هجوم علي السيرفر فا ال SIEM بيكتشفه وال SOAR بيعمله بلوك فا الاتنين بيكملو بعض ولو انو مش اساسي اوي عن ال SIEM اللي دلوقتي موجود ف اي شركه او مؤسسه

---